<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Koi Farm 2 blog | January 2025</title><link rel="stylesheet" type="text/css" href="style.css"><link rel="icon" type="image/png" sizes="16x16" href="favicon_16.png"/><link rel="icon" type="image/png" sizes="32x32" href="favicon_32.png"/><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="rss.xml"></head><body><div id="wrapper"><div id="content"><input type="checkbox" id="dropdown-menu" class="dropdown-checkbox"><label for="dropdown-menu" class="dropdown-toggle"><div id="menu-toggle"><span>Index</span></div></label><div id="index" class="dropdown-menu"><ul><li><a href="2025_07.html">July 2025</a></li><li><a href="2025_06.html">June 2025</a></li><li><a href="2025_05.html">May 2025</a></li><li><a href="2025_04.html">April 2025</a></li><li><a href="2025_03.html">March 2025</a></li><li><a href="2025_02.html">February 2025</a></li><li>January 2025</li><li><hr></li><li><a href="2024_12.html">December 2024</a></li><li><a href="2024_11.html">November 2024</a></li><li><a href="2024_10.html">October 2024</a></li><li><a href="2024_09.html">September 2024</a></li><li><a href="2024_08.html">August 2024</a></li><li><a href="2024_07.html">July 2024</a></li><li><a href="2024_06.html">June 2024</a></li><li><a href="2024_05.html">May 2024</a></li><li><a href="2024_04.html">April 2024</a></li><li><a href="2024_03.html">March 2024</a></li><li><a href="2024_02.html">February 2024</a></li><li><a href="2024_01.html">January 2024</a></li><li><hr></li><li><a href="2023_12.html">December 2023</a></li><li><a href="2023_11.html">November 2023</a></li><hr></ul><a href="rss.xml" title="RSS"><svg height="16px" width="16px" class="icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24.912 24.912" xml:space="preserve"><g><path d="M3.692,17.517C1.656,17.517,0,19.173,0,21.211C0,23.244,1.656,24.9,3.692,24.9s3.694-1.657,3.694-3.689,C7.387,19.173,5.729,17.517,3.692,17.517z"/><path d="M0.384,8.142C0.173,8.142,0,8.315,0,8.527v4.688c0,0.211,0.173,0.383,0.384,0.383c6.02,0,10.919,4.898,10.919,10.92,c0,0.209,0.171,0.383,0.384,0.383h4.689h0.016c0.215,0,0.387-0.173,0.387-0.383l-0.018-0.121C16.692,15.423,9.37,8.142,0.384,8.142,z"/><path d="M24.89,24.397C24.825,10.936,13.854,0.011,0.384,0.011C0.173,0.011,0,0.183,0,0.397v4.824c0,0.212,0.173,0.383,0.384,0.383,c10.429,0,18.913,8.486,18.913,18.914c0,0.209,0.172,0.383,0.382,0.383h4.825h0.02c0.21,0,0.388-0.173,0.388-0.383L24.89,24.397z"/></g></svg></a><a href="https://x.com/jobtalle" target="_blank" title="X"><svg height="16px" width="16px" class="icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" xml:space="preserve"><g><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></g></svg></a></div><div id="blog"><div id="post"><h2>The koi are back</h2><h3>January 2025</h3><p>A great way to find out how much work you've done, is to do it all over. The Javascript prototype felt like a quick experiment, but I've really come to appreciate the amount of work I had already done while porting it. Luckily, the end is in sight, as I've now ported over everything except for the pattern generator, which requires a bit of a redesign since I want to improve upon it.</p><figure><img src="posts\2025_01\debugging.jpg" alt="Developer mode"><figcaption>The development mode interfaces.</figcaption></figure><p>The koi have all their body parts back and swimming around happily. The game now has three different builds:</p><ol><li>The debug build, which is the one I use most often. This build contains all the development interfaces which let me edit all things while the game runs. It gives me detailed information whenever a bug occurs, but it's also unoptimized for that reason.</li><li>The development build, which is optimized and should perform very similarly to the release build. It does however still contain all the development interfaces for testing.</li><li>The release build, which is the build that will eventually be distributed to players. This does not contain development interfaces, and it's the most heavily optimized build.</li></ol><p>The new debug interface is not HTML based like the prototype. I did initially really love the HTML based debugging interface, they seemed very easy to set up and modify. Rewriting them in c++ using ImGui was a breeze though, and it's noticeably faster to write and iterate upon. It's using the "immediate mode" design pattern (hence the name), which doesn't need as much state and therefore potential bugs. Another advantage is that this interface doesn't just run on PCs, but on consoles and phones as well, while web based interfaces aren't universal. This will help to debug console versions in the future.</p><p>Another small improvement I've made to the engine is hot reloading shaders and pipelines. A lot of work is done on the GPU, and with this improvement I can write and test GPU code without restarting the game all the time.</p><figure><img src="posts\2025_01\pick.gif" alt="Picking koi"><figcaption>Koi tossing.</figcaption></figure><p>While porting, I also seized the opportunity to improve systems I know I'll have to rely on later. For example, clicking koi was implemented in a very accurate but rather complex method: I would create a screen size texture and render all koi in the scene to it. Instead of writing colors, I wrote the koi indices to it, read back the texture from the GPU and checked which koi (if any) was at a given pixel position. This method was "pixel perfect", but reading back data from the GPU takes a lot of time, and by the time you have that data, the game has advanced by a few frames already. The method seemed very precise, but in reality, you were clicking on koi in the past and getting the results too late. Implementing this in the new engine was tricky, and although it worked, the latency was too big. I replaced that method by just approximating the koi by a number of spheres, and picking up koi now checks for intersections of the mouse ray with these spheres. Interactions feel snappy again, and I've implemented the single koi moving mode to test this.</p><p>Moving a single koi at a time is useful, but the koi limit of the entire scene is about 4000, so more useful moving methods will be implemented later. Moving a bunch of koi in a net for example is very useful when breeding koi, and there will be methods to quickly filter through large numbers of small fry. These methods need to do many more checks, for which the new koi picking method is much more suitable.</p></div><div id="footer"><span class="previous"><a href="2024_12.html"><< previous</a></span><span class="next"><a href="2025_02.html">next >></a></span></div></div></div></div></body></html>