<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Koi Farm 2 blog | December 2023</title><link rel="stylesheet" type="text/css" href="style.css"><link rel="icon" type="image/png" sizes="16x16" href="favicon_16.png"/><link rel="icon" type="image/png" sizes="32x32" href="favicon_32.png"/><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="rss.xml"></head><body><div id="wrapper"><div id="content"><div id="index"><ul><li><a href="2025_06.html">June 2025</a></li><li><a href="2025_05.html">May 2025</a></li><li><a href="2025_04.html">April 2025</a></li><li><a href="2025_03.html">March 2025</a></li><li><a href="2025_02.html">February 2025</a></li><li><a href="2025_01.html">January 2025</a></li><li><hr></li><li><a href="2024_12.html">December 2024</a></li><li><a href="2024_11.html">November 2024</a></li><li><a href="2024_10.html">October 2024</a></li><li><a href="2024_09.html">September 2024</a></li><li><a href="2024_08.html">August 2024</a></li><li><a href="2024_07.html">July 2024</a></li><li><a href="2024_06.html">June 2024</a></li><li><a href="2024_05.html">May 2024</a></li><li><a href="2024_04.html">April 2024</a></li><li><a href="2024_03.html">March 2024</a></li><li><a href="2024_02.html">February 2024</a></li><li><a href="2024_01.html">January 2024</a></li><li><hr></li><li>December 2023</li><li><a href="2023_11.html">November 2023</a></li><hr></ul><a href="rss.xml"><?xml version="1.0" encoding="iso-8859-1"?><svg height="16px" width="16px" class="icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24.912 24.912" xml:space="preserve"><g><path d="M3.692,17.517C1.656,17.517,0,19.173,0,21.211C0,23.244,1.656,24.9,3.692,24.9s3.694-1.657,3.694-3.689,C7.387,19.173,5.729,17.517,3.692,17.517z"/><path d="M0.384,8.142C0.173,8.142,0,8.315,0,8.527v4.688c0,0.211,0.173,0.383,0.384,0.383c6.02,0,10.919,4.898,10.919,10.92,c0,0.209,0.171,0.383,0.384,0.383h4.689h0.016c0.215,0,0.387-0.173,0.387-0.383l-0.018-0.121C16.692,15.423,9.37,8.142,0.384,8.142,z"/><path d="M24.89,24.397C24.825,10.936,13.854,0.011,0.384,0.011C0.173,0.011,0,0.183,0,0.397v4.824c0,0.212,0.173,0.383,0.384,0.383,c10.429,0,18.913,8.486,18.913,18.914c0,0.209,0.172,0.383,0.382,0.383h4.825h0.02c0.21,0,0.388-0.173,0.388-0.383L24.89,24.397z"/></g></svg></a></div><div id="blog"><div id="post"><h2>Moving to 3d</h2><h3>December 2023</h3><p>Since ponds can now be shaped, it was time to move to 3d and put koi in the ponds. Both pond models and koi models have to be created. Since all models are procedural and generating models can get pretty slow, I moved modelling code to a separate thread. The main thread receives the models when they are ready to prevent any freezes.</p><p>Modelling ponds was pretty straightforward, any pond polygon models a shore that goes inwards towards the maximum pond depth, and any island polygon models a shore that goes from that depth to ground level again. The pond shores can be improved, but they will do for now.</p><figure><img src="posts\2023_12\first_models.gif" alt="The first models"><figcaption>The first animated 3d models</figcaption></figure><p>The koi models will end up being the most complicated models in the game. The placeholders in the video are just for testing animations. I've implemented a skeletal animation system for koi that takes any number of bones (some koi may have more or less fins, short koi need fewer bones), and the skeletons scale with age.</p><p>Finally, the koi need to know how to navigate the pond they're in. To do this, I've implemented a signed <a href="https://en.wikipedia.org/wiki/Signed_distance_function" target="_blank">distance field</a> for every pond, which stores the distance and direction to the shore on a grid. Any islands inside a pond are taken into account, since they are also impassable. The koi in the video simply bounce off the walls of the pond for now. Since there is no lighting model yet, every triangle gets a random color, which helps me debug the shapes early.</p><figure><img src="posts\2023_12\koi_modelling.jpg" alt="Koi modelling"/><figcaption>Koi modelling</figcaption></figure></div><div id="footer"><span class="previous"><a href="2023_11.html"><< previous</a></span><span class="next"><a href="2024_01.html">next >></a></span></div></div></div></div></body></html>